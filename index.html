<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>湘M顺风车发布平台</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: #ff5100;
            color: white;
            padding: 20px 0;
            text-align: center;
            border-radius: 5px;
            margin-bottom: 30px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background-color: #f1f1f1;
            border: 1px solid #ddd;
            border-bottom: none;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
        }
        
        .tab.active {
            background-color: white;
            border-bottom: 1px solid white;
            margin-bottom: -1px;
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
            background-color: white;
            padding: 20px;
            border-radius: 0 5px 5px 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .tab-content.active {
            display: block;
        }
        
        form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        button {
            background-color: #be0000;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #45a049;
        }
        
        .delete-btn {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s;
            margin-top: 10px;
        }
        
        .delete-btn:hover {
            background-color: #c82333;
        }
        
        .success-message {
            background-color: #d4edda;
            color: #155724;
            padding: 10px;
            border: 1px solid #c3e6cb;
            border-radius: 4px;
            margin-bottom: 15px;
            display: none;
        }
        
        .countdown-badge {
            background-color: #ffc107;
            color: #000;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 10px;
            display: inline-block;
        }
        
        .countdown-urgent {
            background-color: #dc3545;
            color: white;
        }
        
        .countdown-expired {
            background-color: #6c757d;
            color: white;
        }
        
        .expiry-notice {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 8px 12px;
            margin-top: 10px;
            font-size: 0.9rem;
            color: #856404;
        }
        
        .full-width {
            grid-column: 1 / -1;
        }
        
        .rides-list {
            display: grid;
            gap: 15px;
        }
        
        .ride-card {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .ride-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .ride-card.car-type {
            border-left: 4px solid #4CAF50;
        }
        
        .ride-card.passenger-type {
            border-left: 4px solid #ff5100;
        }
        
        .ride-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .ride-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #4CAF50;
        }
        
        .ride-title.passenger {
            color: #ff5100;
        }
        
        .ride-date {
            color: #777;
        }
        
        .ride-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .ride-detail {
            display: flex;
            align-items: center;
        }
        
        .ride-detail i {
            margin-right: 8px;
            color: #4CAF50;
        }
        
        .ride-contact {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed #ddd;
            color: #555;
        }
        
        .search-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .search-form input {
            flex: 1;
        }
        
        .no-rides {
            text-align: center;
            padding: 40px;
            color: #777;
        }
        
        @media (max-width: 768px) {
            form {
                grid-template-columns: 1fr;
            }
            
            .ride-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>湘M顺风车发布平台</h1>
            <p class="subtitle">绿色出行 · 共享资源 · 便利生活</p>
        </header>
        
        <div class="tabs">
            <div class="tab active" onclick="switchTab('publish')">车找人</div>
            <div class="tab" onclick="switchTab('find-car')">人找车</div>
            <div class="tab" onclick="switchTab('find')">查找行程</div>
            <div class="tab" onclick="switchTab('my-rides')">我的行程</div>
        </div>
        
        <div id="publish" class="tab-content active">
            <h2>发布车找人信息</h2>
            <div class="expiry-notice">
                <i class="fas fa-info-circle"></i>
                <strong>重要提醒：</strong>发布的行程信息在出发时间过后将自动删除，请确保信息准确。
            </div>
            <form id="ride-form">
                <div class="form-group">
                    <label for="departure">出发地</label>
                    <input type="text" id="departure" placeholder="例如: 王家村村委会" required>
                </div>
                
                <div class="form-group">
                    <label for="destination">目的地</label>
                    <input type="text" id="destination" placeholder="例如: 县城汽车站" required>
                </div>
                
                <div class="form-group">
                    <label for="date">出发日期</label>
                    <input type="date" id="date" required>
                </div>
                
                <div class="form-group">
                    <label for="time">出发时间</label>
                    <input type="time" id="time" required>
                </div>
                
                <div class="form-group">
                    <label for="seats">可用座位</label>
                    <select id="seats" required>
                        <option value="">请选择</option>
                        <option value="1">1个座位</option>
                        <option value="2">2个座位</option>
                        <option value="3">3个座位</option>
                        <option value="4">4个座位</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="price">每人费用</label>
                    <input type="number" id="price" placeholder="例如: 10" required>
                </div>
                
                <div class="form-group full-width">
                    <label for="notes">备注信息</label>
                    <textarea id="notes" rows="3" placeholder="例如: 后备箱空间有限，大件行李请提前告知"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="name">联系人</label>
                    <input type="text" id="name" placeholder="您的姓名" required>
                </div>
                
                <div class="form-group">
                    <label for="phone">联系电话</label>
                    <input type="tel" id="phone" placeholder="您的手机号码" required>
                </div>
                
                <div class="form-group full-width">
                    <button type="submit">发布车找人信息</button>
                </div>
            </form>
        </div>
        
        <div id="find-car" class="tab-content">
            <h2>发布人找车信息</h2>
            <div class="expiry-notice">
                <i class="fas fa-info-circle"></i>
                <strong>重要提醒：</strong>发布的乘车需求在出发时间过后将自动删除，请确保信息准确。
            </div>
            <form id="passenger-form">
                <div class="form-group">
                    <label for="passenger-departure">出发地</label>
                    <input type="text" id="passenger-departure" placeholder="例如: 李家村小学" required>
                </div>
                
                <div class="form-group">
                    <label for="passenger-destination">目的地</label>
                    <input type="text" id="passenger-destination" placeholder="例如: 县城医院" required>
                </div>
                
                <div class="form-group">
                    <label for="passenger-date">出发日期</label>
                    <input type="date" id="passenger-date" required>
                </div>
                
                <div class="form-group">
                    <label for="passenger-time">出发时间</label>
                    <input type="time" id="passenger-time" required>
                </div>
                
                <div class="form-group">
                    <label for="passenger-count">乘车人数</label>
                    <select id="passenger-count" required>
                        <option value="">请选择</option>
                        <option value="1">1人</option>
                        <option value="2">2人</option>
                        <option value="3">3人</option>
                        <option value="4">4人</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="passenger-budget">预算费用</label>
                    <input type="number" id="passenger-budget" placeholder="例如: 15" required>
                </div>
                
                <div class="form-group full-width">
                    <label for="passenger-notes">特别需求</label>
                    <textarea id="passenger-notes" rows="3" placeholder="例如: 有儿童座椅需求，有大件行李"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="passenger-name">联系人</label>
                    <input type="text" id="passenger-name" placeholder="您的姓名" required>
                </div>
                
                <div class="form-group">
                    <label for="passenger-phone">联系电话</label>
                    <input type="tel" id="passenger-phone" placeholder="您的手机号码" required>
                </div>
                
                <div class="form-group full-width">
                    <button type="submit">发布人找车信息</button>
                </div>
            </form>
        </div>
        
        <div id="find" class="tab-content">
            <h2>查找顺风车</h2>
            
            <div class="search-form">
                <input type="text" id="search-input" placeholder="搜索出发地或目的地..." onkeypress="handleSearchKeyPress(event)">
                <button onclick="searchRides()"><i class="fas fa-search"></i> 搜索</button>
            </div>
            
            <div id="rides-container">
                <div class="no-rides">
                    <i class="fas fa-car fa-3x" style="color: #ddd; margin-bottom: 15px;"></i>
                    <p>暂无可用行程，请稍后再试或发布您的行程</p>
                </div>
            </div>
        </div>
        
        <div id="my-rides" class="tab-content">
            <h2>我的行程</h2>
            
            <div id="my-rides-container">
                <div class="no-rides">
                    <i class="fas fa-user fa-3x" style="color: #ddd; margin-bottom: 15px;"></i>
                    <p>您还没有发布过行程</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 使用localStorage进行持久化数据存储
        function getRides() {
            const stored = localStorage.getItem('carpoolRides');
            return stored ? JSON.parse(stored) : [];
        }
        
        function saveRides(rides) {
            localStorage.setItem('carpoolRides', JSON.stringify(rides));
        }
        
        // 人找车数据存储
        function getPassengers() {
            const stored = localStorage.getItem('carpoolPassengers');
            return stored ? JSON.parse(stored) : [];
        }
        
        function savePassengers(passengers) {
            localStorage.setItem('carpoolPassengers', JSON.stringify(passengers));
        }
        
        let rides = getRides();
        let passengers = getPassengers();
        
        // 检查行程是否过期（超过出发时间）
        function isExpired(item) {
            const itemDateTime = new Date(item.date + ' ' + item.time);
            const currentDateTime = new Date();
            return itemDateTime < currentDateTime;
        }
        
        // 自动清理过期数据
        function cleanExpiredData() {
            // 清理过期的车找人数据
            rides = rides.filter(ride => !isExpired(ride));
            // 清理过期的人找车数据
            passengers = passengers.filter(passenger => !isExpired(passenger));
            // 保存清理后的数据
            saveRides(rides);
            savePassengers(passengers);
        }
        
        // 获取倒计时显示文本
        function getCountdownText(item) {
            const itemDateTime = new Date(item.date + ' ' + item.time);
            const currentDateTime = new Date();
            const diffTime = itemDateTime - currentDateTime;
            
            if (diffTime < 0) {
                return { text: '已过期', class: 'countdown-expired' };
            }
            
            const diffHours = Math.floor(diffTime / (1000 * 60 * 60));
            const diffDays = Math.floor(diffHours / 24);
            const remainingHours = diffHours % 24;
            
            if (diffDays === 0) {
                if (diffHours === 0) {
                    return { text: '即将过期', class: 'countdown-urgent' };
                } else if (diffHours <= 2) {
                    return { text: `剩余${diffHours}小时`, class: 'countdown-urgent' };
                } else {
                    return { text: `剩余${diffHours}小时`, class: 'countdown-badge' };
                }
            } else if (diffDays === 1) {
                return { text: `明天${remainingHours > 0 ? remainingHours + '点' : '出发'}`, class: 'countdown-badge' };
            } else {
                return { text: `${diffDays}天后出发`, class: 'countdown-badge' };
            }
        }
        
        // 获取有效的行程数据（自动清理过期数据）
        function getValidItems(items) {
            cleanExpiredData();
            return items.filter(item => !isExpired(item));
        }
        
        // 切换标签页
        function switchTab(tabId) {
            // 隐藏所有标签内容
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // 取消所有标签的活动状态
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // 显示选中的标签内容
            document.getElementById(tabId).classList.add('active');
            
            // 设置选中标签的活动状态
            event.currentTarget.classList.add('active');
            
            // 如果是查找行程标签，刷新列表
            if (tabId === 'find') {
                displayRides(rides, passengers);
            }
            
            // 如果是我的行程标签，刷新列表
            if (tabId === 'my-rides') {
                displayMyRides();
            }
        }
        
        // 提交表单
        document.getElementById('ride-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // 获取表单数据
            const ride = {
                id: Date.now(),
                departure: document.getElementById('departure').value,
                destination: document.getElementById('destination').value,
                date: document.getElementById('date').value,
                time: document.getElementById('time').value,
                seats: document.getElementById('seats').value,
                price: document.getElementById('price').value,
                notes: document.getElementById('notes').value,
                name: document.getElementById('name').value,
                phone: document.getElementById('phone').value,
                timestamp: new Date().toISOString()
            };
            
            // 添加到行程列表并保存到本地存储
            rides.push(ride);
            saveRides(rides);
            
            // 清空表单
            this.reset();
            
            // 显示成功消息
            showSuccessMessage('车找人信息发布成功！数据已保存到本地存储。');
            
            // 切换到我的行程标签
            setTimeout(() => {
                document.querySelector('.tab[onclick="switchTab(\'my-rides\')"]').click();
            }, 1500);
        });
        
        // 人找车表单提交
        document.getElementById('passenger-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // 获取表单数据
            const passenger = {
                id: Date.now(),
                departure: document.getElementById('passenger-departure').value,
                destination: document.getElementById('passenger-destination').value,
                date: document.getElementById('passenger-date').value,
                time: document.getElementById('passenger-time').value,
                passengerCount: document.getElementById('passenger-count').value,
                budget: document.getElementById('passenger-budget').value,
                notes: document.getElementById('passenger-notes').value,
                name: document.getElementById('passenger-name').value,
                phone: document.getElementById('passenger-phone').value,
                timestamp: new Date().toISOString(),
                type: 'passenger'
            };
            
            // 添加到人找车列表并保存到本地存储
            passengers.push(passenger);
            savePassengers(passengers);
            
            // 清空表单
            this.reset();
            
            // 显示成功消息
            showSuccessMessage('人找车信息发布成功！数据已保存到本地存储。');
            
            // 切换到查找行程标签
            setTimeout(() => {
                document.querySelector('.tab[onclick="switchTab(\'find\')"]').click();
            }, 1500);
        });
        
        // 显示行程列表（包含车找人和人找车）
        function displayRides(ridesToDisplay, passengersToDisplay) {
            const container = document.getElementById('rides-container');
            
            // 自动清理过期数据并获取有效行程
            const validRides = ridesToDisplay.length === rides.length ? getValidItems(ridesToDisplay) : ridesToDisplay;
            const validPassengers = passengersToDisplay.length === passengers.length ? getValidItems(passengersToDisplay) : passengersToDisplay;
            
            const allItems = [...validRides, ...validPassengers];
            
            if (allItems.length === 0) {
                container.innerHTML = `
                    <div class="no-rides">
                        <i class="fas fa-car fa-3x" style="color: #ddd; margin-bottom: 15px;"></i>
                        <p>暂无可用行程，请稍后再试或发布您的行程</p>
                        <p style="font-size: 0.9rem; color: #6c757d;">过期行程已自动清理</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = '';
            
            // 显示车找人信息
            ridesToDisplay.forEach(ride => {
                const rideDate = new Date(ride.date).toLocaleDateString('zh-CN');
                const rideTime = ride.time.substring(0, 5);
                const countdown = getCountdownText(ride);
                
                container.innerHTML += `
                    <div class="ride-card car-type">
                        <div class="ride-header">
                            <div class="ride-title">
                                <i class="fas fa-car"></i>
                                车找人：${ride.departure} → ${ride.destination}
                                <span class="${countdown.class}">${countdown.text}</span>
                            </div>
                            <div class="ride-date">${rideDate} ${rideTime}</div>
                        </div>
                        <div class="ride-details">
                            <div class="ride-detail">
                                <i class="fas fa-users"></i>
                                <span>${ride.seats}个座位</span>
                            </div>
                            <div class="ride-detail">
                                <i class="fas fa-money-bill-wave"></i>
                                <span>${ride.price}元/人</span>
                            </div>
                            <div class="ride-detail">
                                <i class="fas fa-user"></i>
                                <span>${ride.name}</span>
                            </div>
                            <div class="ride-detail">
                                <i class="fas fa-phone"></i>
                                <span>${ride.phone}</span>
                            </div>
                        </div>
                        ${ride.notes ? `<div class="ride-contact">备注: ${ride.notes}</div>` : ''}
                    </div>
                `;
            });
            
            // 显示人找车信息
            passengersToDisplay.forEach(passenger => {
                const passengerDate = new Date(passenger.date).toLocaleDateString('zh-CN');
                const passengerTime = passenger.time.substring(0, 5);
                const countdown = getCountdownText(passenger);
                
                container.innerHTML += `
                    <div class="ride-card passenger-type">
                        <div class="ride-header">
                            <div class="ride-title passenger">
                                <i class="fas fa-user-friends"></i>
                                人找车：${passenger.departure} → ${passenger.destination}
                                <span class="${countdown.class}">${countdown.text}</span>
                            </div>
                            <div class="ride-date">${passengerDate} ${passengerTime}</div>
                        </div>
                        <div class="ride-details">
                            <div class="ride-detail">
                                <i class="fas fa-user-friends"></i>
                                <span>${passenger.passengerCount}人乘车</span>
                            </div>
                            <div class="ride-detail">
                                <i class="fas fa-money-bill-wave"></i>
                                <span>预算${passenger.budget}元/人</span>
                            </div>
                            <div class="ride-detail">
                                <i class="fas fa-user"></i>
                                <span>${passenger.name}</span>
                            </div>
                            <div class="ride-detail">
                                <i class="fas fa-phone"></i>
                                <span>${passenger.phone}</span>
                            </div>
                        </div>
                        ${passenger.notes ? `<div class="ride-contact">特别需求: ${passenger.notes}</div>` : ''}
                    </div>
                `;
            });
        }
        
        // 显示我的行程
        function displayMyRides() {
            const container = document.getElementById('my-rides-container');
            
            // 自动清理过期数据
            cleanExpiredData();
            
            const allMyItems = [...rides, ...passengers];
            
            if (allMyItems.length === 0) {
                container.innerHTML = `
                    <div class="no-rides">
                        <i class="fas fa-user fa-3x" style="color: #ddd; margin-bottom: 15px;"></i>
                        <p>您还没有发布过行程</p>
                        <p style="font-size: 0.9rem; color: #6c757d;">过期行程已自动清理</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = '';
            
            // 显示车找人信息
            rides.forEach(ride => {
                const rideDate = new Date(ride.date).toLocaleDateString('zh-CN');
                const rideTime = ride.time.substring(0, 5);
                const countdown = getCountdownText(ride);
                
                container.innerHTML += `
                    <div class="ride-card car-type">
                        <div class="ride-header">
                            <div class="ride-title">
                                <i class="fas fa-car"></i>
                                车找人：${ride.departure} → ${ride.destination}
                                <span class="${countdown.class}">${countdown.text}</span>
                            </div>
                            <div class="ride-date">${rideDate} ${rideTime}</div>
                        </div>
                        <div class="ride-details">
                            <div class="ride-detail">
                                <i class="fas fa-users"></i>
                                <span>${ride.seats}个座位</span>
                            </div>
                            <div class="ride-detail">
                                <i class="fas fa-money-bill-wave"></i>
                                <span>${ride.price}元/人</span>
                            </div>
                            <div class="ride-detail">
                                <i class="fas fa-user"></i>
                                <span>${ride.name}</span>
                            </div>
                            <div class="ride-detail">
                                <i class="fas fa-phone"></i>
                                <span>${ride.phone}</span>
                            </div>
                        </div>
                        ${ride.notes ? `<div class="ride-contact">备注: ${ride.notes}</div>` : ''}
                        <button class="delete-btn" onclick="deleteRide(${ride.id})">
                            <i class="fas fa-trash"></i> 删除
                        </button>
                    </div>
                `;
            });
            
            // 显示人找车信息
            passengers.forEach(passenger => {
                const passengerDate = new Date(passenger.date).toLocaleDateString('zh-CN');
                const passengerTime = passenger.time.substring(0, 5);
                const countdown = getCountdownText(passenger);
                
                container.innerHTML += `
                    <div class="ride-card passenger-type">
                        <div class="ride-header">
                            <div class="ride-title passenger">
                                <i class="fas fa-user-friends"></i>
                                人找车：${passenger.departure} → ${passenger.destination}
                                <span class="${countdown.class}">${countdown.text}</span>
                            </div>
                            <div class="ride-date">${passengerDate} ${passengerTime}</div>
                        </div>
                        <div class="ride-details">
                            <div class="ride-detail">
                                <i class="fas fa-user-friends"></i>
                                <span>${passenger.passengerCount}人乘车</span>
                            </div>
                            <div class="ride-detail">
                                <i class="fas fa-money-bill-wave"></i>
                                <span>预算${passenger.budget}元/人</span>
                            </div>
                            <div class="ride-detail">
                                <i class="fas fa-user"></i>
                                <span>${passenger.name}</span>
                            </div>
                            <div class="ride-detail">
                                <i class="fas fa-phone"></i>
                                <span>${passenger.phone}</span>
                            </div>
                        </div>
                        ${passenger.notes ? `<div class="ride-contact">特别需求: ${passenger.notes}</div>` : ''}
                        <button class="delete-btn" onclick="deletePassenger(${passenger.id})">
                            <i class="fas fa-trash"></i> 删除
                        </button>
                    </div>
                `;
            });
        }
        
        // 处理搜索框回车事件
        function handleSearchKeyPress(event) {
            if (event.key === 'Enter') {
                searchRides();
            }
        }
        
        // 搜索行程（同时搜索车找人和人找车）
        function searchRides() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            
            if (!searchTerm) {
                displayRides(rides, passengers);
                return;
            }
            
            const filteredRides = rides.filter(ride => 
                ride.departure.toLowerCase().includes(searchTerm) || 
                ride.destination.toLowerCase().includes(searchTerm) ||
                ride.name.toLowerCase().includes(searchTerm)
            );
            
            const filteredPassengers = passengers.filter(passenger => 
                passenger.departure.toLowerCase().includes(searchTerm) || 
                passenger.destination.toLowerCase().includes(searchTerm) ||
                passenger.name.toLowerCase().includes(searchTerm)
            );
            
            displayRides(filteredRides, filteredPassengers);
            
            // 显示搜索结果统计
            const totalResults = filteredRides.length + filteredPassengers.length;
            if (searchTerm && totalResults > 0) {
                showSuccessMessage(`找到 ${totalResults} 条相关行程信息`);
            } else if (searchTerm && totalResults === 0) {
                showSuccessMessage('没有找到匹配的行程信息');
            }
        }
        
        // 显示成功消息
        function showSuccessMessage(message) {
            // 在页面顶部显示成功消息
            const successDiv = document.createElement('div');
            successDiv.className = 'success-message';
            successDiv.textContent = message;
            successDiv.style.display = 'block';
            successDiv.style.position = 'fixed';
            successDiv.style.top = '20px';
            successDiv.style.left = '50%';
            successDiv.style.transform = 'translateX(-50%)';
            successDiv.style.zIndex = '1000';
            successDiv.style.padding = '15px 30px';
            successDiv.style.borderRadius = '5px';
            successDiv.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
            
            document.body.appendChild(successDiv);
            
            // 3秒后自动移除
            setTimeout(() => {
                if (successDiv.parentNode) {
                    successDiv.parentNode.removeChild(successDiv);
                }
            }, 3000);
        }
        
        // 删除行程
        function deleteRide(id) {
            if (confirm('确定要删除这条行程吗？')) {
                rides = rides.filter(ride => ride.id !== id);
                saveRides(rides);
                displayMyRides();
                showSuccessMessage('行程删除成功！');
            }
        }
        
        // 删除人找车信息
        function deletePassenger(id) {
            if (confirm('确定要删除这条人找车信息吗？')) {
                passengers = passengers.filter(passenger => passenger.id !== id);
                savePassengers(passengers);
                displayMyRides();
                showSuccessMessage('人找车信息删除成功！');
            }
        }
        

        
        // 初始化一些示例数据
        function initSampleData() {
            if (rides.length === 0) {
                // 获取当前日期和时间
                const now = new Date();
                const today = new Date(now);
                today.setHours(today.getHours() + 2); // 2小时后
                const todayStr = today.toISOString().split('T')[0];
                const todayTime = today.toTimeString().substring(0, 5);
                
                const tomorrow = new Date(now);
                tomorrow.setDate(tomorrow.getDate() + 1);
                tomorrow.setHours(9, 0); // 明天9点
                const tomorrowStr = tomorrow.toISOString().split('T')[0];
                const tomorrowTime = tomorrow.toTimeString().substring(0, 5);
                
                const dayAfter = new Date(now);
                dayAfter.setDate(dayAfter.getDate() + 2);
                dayAfter.setHours(14, 30); // 后天14:30
                const dayAfterStr = dayAfter.toISOString().split('T')[0];
                const dayAfterTime = dayAfter.toTimeString().substring(0, 5);
                
                rides = [
                    {
                        id: 1,
                        departure: "李家村",
                        destination: "县城中心",
                        date: todayStr,
                        time: todayTime,
                        seats: "3",
                        price: "15",
                        notes: "可接送，后备箱空间大",
                        name: "张师傅",
                        phone: "13800138000",
                        timestamp: now.toISOString()
                    },
                    {
                        id: 2,
                        departure: "王家镇",
                        destination: "市里火车站",
                        date: tomorrowStr,
                        time: tomorrowTime,
                        seats: "2",
                        price: "25",
                        notes: "走高速，约1小时到达",
                        name: "王师傅",
                        phone: "13900139000",
                        timestamp: now.toISOString()
                    },
                    {
                        id: 3,
                        departure: "周家庄",
                        destination: "县城农贸市场",
                        date: dayAfterStr,
                        time: dayAfterTime,
                        seats: "4",
                        price: "8",
                        notes: "每天往返，可提前预约",
                        name: "周师傅",
                        phone: "13500135000",
                        timestamp: now.toISOString()
                    }
                ];
                saveRides(rides);
            }
            
            if (passengers.length === 0) {
                // 使用当前日期和时间计算未来几天的日期
                const now = new Date();
                const today = new Date(now);
                today.setHours(today.getHours() + 3); // 3小时后
                const todayStr = today.toISOString().split('T')[0];
                const todayTime = today.toTimeString().substring(0, 5);
                
                const tomorrow = new Date(now);
                tomorrow.setDate(tomorrow.getDate() + 1);
                tomorrow.setHours(15, 0); // 明天15点
                const tomorrowStr = tomorrow.toISOString().split('T')[0];
                const tomorrowTime = tomorrow.toTimeString().substring(0, 5);
                
                const dayAfter = new Date(now);
                dayAfter.setDate(dayAfter.getDate() + 2);
                dayAfter.setHours(10, 0); // 后天10点
                const dayAfterStr = dayAfter.toISOString().split('T')[0];
                const dayAfterTime = dayAfter.toTimeString().substring(0, 5);
                
                passengers = [
                    {
                        id: 1001,
                        departure: "赵家村",
                        destination: "县城医院",
                        date: todayStr,
                        time: todayTime,
                        passengerCount: "2",
                        budget: "20",
                        notes: "有老人同行，需要提前安排",
                        name: "赵先生",
                        phone: "13600136000",
                        timestamp: now.toISOString(),
                        type: 'passenger'
                    },
                    {
                        id: 1002,
                        departure: "孙家屯",
                        destination: "县城汽车站",
                        date: tomorrowStr,
                        time: tomorrowTime,
                        passengerCount: "3",
                        budget: "12",
                        notes: "有大件行李，求拼车",
                        name: "孙女士",
                        phone: "13700137000",
                        timestamp: now.toISOString(),
                        type: 'passenger'
                    },
                    {
                        id: 1003,
                        departure: "钱家村",
                        destination: "市中心商场",
                        date: dayAfterStr,
                        time: dayAfterTime,
                        passengerCount: "1",
                        budget: "30",
                        notes: "购物，希望车空间大一些",
                        name: "钱同学",
                        phone: "13800138001",
                        timestamp: now.toISOString(),
                        type: 'passenger'
                    }
                ];
                savePassengers(passengers);
            }
        }
        
        // 页面加载时初始化
        window.addEventListener('load', function() {
            initSampleData();
            
            // 默认显示查找行程标签
            document.querySelector('.tab[onclick="switchTab(\'find\')"]').click();
        });
    </script>
</body>
</html>
